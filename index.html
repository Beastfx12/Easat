<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MetroCheck CRB Checker - Kenya's Leading Credit Platform</title>
    <meta name="description" content="Transform your financial journey with instant CRB verification. Get real-time credit insights and unlock borrowing opportunities from top lending institutions in Kenya." />
    <meta name="author" content="MetroCheck CRB Checker" />
    <meta name="keywords" content="CRB Kenya, credit check, CRB status, credit score, loan eligibility, blacklist clearance" />
    <link rel="canonical" href="https://metropolcrbchecker.co.ke" />

    <meta property="og:title" content="MetroCheck CRB Checker - Unlock Your Financial Freedom" />
    <meta property="og:description" content="Kenya's leading CRB status verification platform. Get instant credit insights and unlock borrowing opportunities." />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="MetroCheck CRB Checker - Unlock Your Financial Freedom" />
    <meta name="twitter:description" content="Kenya's leading CRB status verification platform. Get instant credit insights." />
    <meta name="twitter:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />
    <script>
      window.__SUPABASE_OVERRIDE__ = true;
      const originalFetch = window.fetch;
      window.fetch = function(url, options) {
        let urlStr = typeof url === 'string' ? url : (url instanceof Request ? url.url : url.toString());
        const isSupabase = /supabase\.(co|in|red)/.test(urlStr);
        if ((isSupabase || urlStr.includes('functions/v1')) && urlStr.includes('initiate-payment')) {
          console.log('Redirecting payment request to local API:', urlStr);
          url = '/functions/v1/initiate-payment';
        }
        if ((isSupabase || urlStr.includes('functions/v1')) && urlStr.includes('check-payment-status')) {
          console.log('Redirecting status check to local API:', urlStr);
          url = '/functions/v1/check-payment-status';
        }
        return originalFetch.apply(this, [url, options]);
      };
    </script>
    <script>
      async function updateKenyansCounter() {
        try {
          const response = await fetch('/api/stats/counter');
          const data = await response.json();
          if (data.success) {
            const targetText = 'Kenyans checked their CRB status this week';
            const newText = 'Kenyans checked their CRB status this week and recommend this website';
            
            function findAndUpdateElements() {
              const walker = document.createTreeWalker(
                document.body,
                NodeFilter.SHOW_TEXT,
                null,
                false
              );
              
              let node;
              while (node = walker.nextNode()) {
                if (node.textContent.includes(targetText)) {
                  node.textContent = node.textContent.replace(targetText, newText);
                }
                const numMatch = node.textContent.match(/^(\d{1,3}(,\d{3})*)\+$/);
                if (numMatch && node.parentElement) {
                  const parent = node.parentElement;
                  const sibling = parent.nextElementSibling || parent.parentElement;
                  if (sibling && (sibling.textContent.includes('Kenyans') || sibling.textContent.includes('CRB'))) {
                    node.textContent = data.formatted;
                  }
                }
              }
              
              document.querySelectorAll('*').forEach(el => {
                if (el.childNodes.length === 1 && el.childNodes[0].nodeType === 3) {
                  const text = el.textContent.trim();
                  if (/^\d{1,3}(,\d{3})*\+$/.test(text)) {
                    const parentText = el.parentElement ? el.parentElement.textContent : '';
                    if (parentText.includes('Kenyans') || parentText.includes('CRB')) {
                      el.textContent = data.formatted;
                    }
                  }
                }
              });
            }
            
            findAndUpdateElements();
            
            const observer = new MutationObserver(() => {
              findAndUpdateElements();
            });
            observer.observe(document.body, { childList: true, subtree: true });
            
            setTimeout(() => observer.disconnect(), 10000);
          }
        } catch (error) {
          console.error('Error fetching counter:', error);
        }
      }
      
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => {
          setTimeout(updateKenyansCounter, 500);
        });
      } else {
        setTimeout(updateKenyansCounter, 500);
      }
      
      setInterval(updateKenyansCounter, 3600000);
    </script>
    <script type="module" crossorigin src="/assets/index-Bzc0YBM6.js"></script>
    <link rel="stylesheet" crossorigin href="/assets/index-DW4APKIN.css">
  </head>

  <body>
    <div id="root"></div>
  </body>
</html>
